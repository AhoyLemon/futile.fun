"use strict";

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

var begin = {
  s: {
    bottom: 0,
    left: 2
  },
  r: {
    bottom: 3,
    left: 2
  }
};

var sDefaults = {
  bottom: begin.s.bottom,
  left: begin.s.left,
  width: 2.4,
  height: 7,
  retreating: false,
  pushForce: 1.6,
  retreatSpeed: 2.6
};

var rDefaults = {
  bottom: begin.r.bottom,
  left: begin.r.left,
  width: 17,
  height: 17,
  marginLeft: -3.6
};
var storeItems = [{
  id: 1, name: "Fresh Kicks", price: 5,
  desc: "Better arch support means that you can move slightly faster"
}, {
  id: 2, name: "Small pickaxe", price: 50,
  desc: "It's not the sharpest, but it's enough to carve out a little bit of the rock to make it slightly smaller."
}, {
  id: 3, name: "A whole bunch of gum", price: 15,
  desc: "Like, a considerable amount of gum. Enough to stick to the boulder to make it bigger"
}, {
  id: 4, name: "Analgesic Heat Rub", price: 25,
  desc: "Smells terrible! But should allow you to push to boulder a little bit faster."
}];
function randomNumber(min, max) {
  return Math.floor(Math.random() * (max - min)) + min;
}

function workThisArray(myArray) {

  var r = Math.floor(Math.random() * myArray.length);
  var message = '';

  myArray[r].forEach(function (k) {
    //console.log(typeof k);
    if ((typeof k === "undefined" ? "undefined" : _typeof(k)) == "object") {
      //console.log(k)
      var z = Math.floor(Math.random() * k.length);

      if (_typeof(k[z]) == "object") {
        k[z].forEach(function (a) {
          if ((typeof a === "undefined" ? "undefined" : _typeof(a)) == "object") {
            message += a[Math.floor(Math.random() * a.length)];
          } else {
            message += a;
          }
        });
      } else {
        message += k[z];
      }
    } else {
      message += k;
    }
  });
  return message;
}

function stringInArray(s, a) {
  var n = a.indexOf(s);
  if (n > -1) {
    return true;
  } else {
    return false;
  }
}

function randomFrom(array) {
  return array[Math.floor(Math.random() * array.length)];
}

function shuffle(o) {
  for (var j, x, i = o.length; i; j = Math.floor(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x) {}
  return o;
}

function capitalize(string) {
  return string.charAt(0).toUpperCase() + string.slice(1);
}

function bold(string) {
  return '<strong>' + string + '</strong>';
}

function similarity(s1, s2) {
  var longer = s1;
  var shorter = s2;
  if (s1.length < s2.length) {
    longer = s2;
    shorter = s1;
  }
  var longerLength = longer.length;
  if (longerLength == 0) {
    return 1.0;
  }
  return (longerLength - editDistance(longer, shorter)) / parseFloat(longerLength);
}

function editDistance(s1, s2) {
  s1 = s1.toLowerCase();
  s2 = s2.toLowerCase();

  var costs = [];
  for (var i = 0; i <= s1.length; i++) {
    var lastValue = i;
    for (var j = 0; j <= s2.length; j++) {
      if (i == 0) costs[j] = j;else {
        if (j > 0) {
          var newValue = costs[j - 1];
          if (s1.charAt(i - 1) != s2.charAt(j - 1)) newValue = Math.min(Math.min(newValue, lastValue), costs[j]) + 1;
          costs[j - 1] = lastValue;
          lastValue = newValue;
        }
      }
    }
    if (i > 0) costs[s2.length] = lastValue;
  }
  return costs[s2.length];
}

function testChance(chance) {
  var r = Math.floor(Math.random() * 100) + 1;
  if (chance >= r) {
    return true;
  } else {
    return false;
  }
}

function sendEvent(c, a, l, v) {
  if (v) {
    ga('send', 'event', { eventCategory: c, eventAction: a, eventLabel: l, eventValue: v });
    console.log('CATEGORY: ' + c + ', ACTION:' + a + ', LABEL:' + l + ', VALUE:' + v);
  } else if (l) {
    ga('send', 'event', { eventCategory: c, eventAction: a, eventLabel: l });
    console.log('CATEGORY: ' + c + ', ACTION:' + a + ', LABEL:' + l);
  } else {
    ga('send', 'event', { eventCategory: c, eventAction: a });
    console.log('CATEGORY: ' + c + ', ACTION:' + a);
  }
}
//@prepros-prepend partials/_variables.js
//@prepros-prepend partials/_store.js
//@prepros-prepend partials/_functions.js

//@prepros-append partials/_vue.js
Vue.directive('focus', {
  // When the bound element is inserted into the DOM...
  inserted: function inserted(el) {
    // Focus the element
    el.focus();
  }
});

var app = new Vue({
  el: '#app',
  data: {
    phase: 'begin',
    message: 'Help Sisyphus push the rock uphill.',
    score: 0,
    totalScore: 0,
    s: sDefaults,
    r: rDefaults,
    store: storeItems,
    inventory: []
  },

  methods: {
    sisyphusClick: function sisyphusClick() {
      var self = this;
      var f = self.s.pushForce;
      var r = self.s.retreatSpeed;

      if (self.s.retreating == false) {

        if (self.phase != 'begin' && self.phase != 'pushing') {
          self.switchMessage('pushing');
        }
        self.score++;
        self.totalScore++;
        self.s.bottom += f;
        self.s.left += f;

        self.r.bottom += f;
        self.r.left += f;

        if (self.r.left > 70) {
          self.r.bottom = begin.r.bottom;
          self.r.left = begin.r.left;
          self.r.falling = true;
          self.s.retreating = true;
          self.switchMessage('falling');
        }
      } else if (self.s.retreating == true) {
        self.s.bottom -= r;
        self.s.left -= r;
        if (self.phase != 'retreat') {
          self.switchMessage('retreat');
        }
        if (self.s.bottom <= begin.s.bottom || self.s.left <= begin.s.left) {
          self.s.retreating = false;
          self.s.bottom = begin.s.bottom;
          self.s.left = begin.s.left;
          self.r.falling = false;
        }
      }
    },
    buyItem: function buyItem(i, item) {
      var self = this;

      if (self.score >= item.price) {
        self.score -= item.price;
        var n = self.store[i];
        self.inventory.push(n);
        self.store.splice(i, 1);
        self.buyItemEffect(item.id);
      }
    },
    buyItemEffect: function buyItemEffect(id) {
      var self = this;
      if (id == 1) {
        // Fresh Kicks
        self.s.pushForce = self.s.pushForce * 1.01;
        self.s.retreatSpeed = self.s.pushForce * 1.7;
      } else if (id == 2) {
        // small pickaxe
        self.r.height = self.r.height * 0.85;
        self.r.width = self.r.width * 0.85;
        self.s.pushForce = self.s.pushForce * 1.5;
      } else if (id == 3) {
        // gum
        self.r.height = self.r.height * 1.15;
        self.r.width = self.r.width * 1.15;
        self.s.pushForce = self.s.pushForce * 0.5;
      } else if (id == 3) {
        // analgesic
        self.s.pushForce = self.s.pushForce * 2;
      }
    },
    switchMessage: function switchMessage(m) {
      var self = this;
      self.phase = m;
      if (m == 'falling') {
        self.message = "Uh oh!";
      } else if (m == "retreat") {
        self.message = "Go back and get it.";
      } else if (m == "pushing") {
        self.message = "Keep going.";
      }
    }
  },

  computed: {
    rockLeft: function rockLeft() {
      return 'calc(' + this.s.width + '% + ' + this.r.left + '%)';
    },
    rockHeight: function rockHeight() {
      return this.r.height + '%';
    },
    rockWidth: function rockWidth() {
      return this.r.width + '%';
    },
    rockMarginLeft: function rockMarginLeft() {
      return this.r.marginLeft + '%';
    }
  }

});
//# sourceMappingURL=sisyphus.min.js.map